<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ludvig Renbo Olsen" />

<meta name="date" content="2025-03-03" />

<title>README for xpectr</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
p.abstract{
text-align: center;
font-weight: bold;
}
div.abstract{
margin: auto;
width: 90%;
}
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>
<style type="text/css">h1 {
font-size:190%;
padding-top:20px;
}
hr {
border-style: solid;
border: none;
border-top: 0.5px solid #777;
margin: 28px 0;
}
img {
margin-top: 20px;
margin-bottom: 20px;
}
p {
padding-bottom:7px;
}
</style>




</head>

<body>




<h1 class="title toc-ignore">README for xpectr</h1>
<h4 class="author">Ludvig Renbo Olsen</h4>
<h4 class="date">2025-03-03</h4>
<div class="abstract">
<p class="abstract">Abstract</p>
<p>This vignette is an introduction to the <code>xpectr</code> package.
<code>xpectr</code> provides a set of utilities and RStudio addins for
generating tests for <code>testthat</code> unit testing.  <br />
 <br />
Contact author at <a href="mailto:r-pkgs@ludvigolsen.dk" class="email">r-pkgs@ludvigolsen.dk</a>  <br />
 </p>
</div>


<div id="TOC">
<ul>
<li><a href="#installation" id="toc-installation">Installation</a></li>
<li><a href="#main-functions" id="toc-main-functions">Main functions</a>
<ul>
<li><a href="#generator-functions" id="toc-generator-functions">Generator functions</a></li>
<li><a href="#functions-for-use-in-tests" id="toc-functions-for-use-in-tests">Functions for use in tests</a></li>
<li><a href="#helper-functions" id="toc-helper-functions">Helper
functions</a></li>
</ul></li>
<li><a href="#addins" id="toc-addins">Addins</a></li>
<li><a href="#using-in-packages" id="toc-using-in-packages">Using in
packages</a></li>
<li><a href="#examples" id="toc-examples">Examples</a>
<ul>
<li><a href="#gxs_selection" id="toc-gxs_selection">gxs_selection</a></li>
<li><a href="#gxs_function" id="toc-gxs_function">gxs_function</a></li>
<li><a href="#rstudio-addins" id="toc-rstudio-addins">RStudio
Addins</a></li>
</ul></li>
</ul>
</div>

<p>When developing R packages, it’s good practice to build a good set of
unit and regression tests that will notify you when something breaks in
the future. For this, the <a href="https://testthat.r-lib.org/"><code>testthat</code></a> package is
commonly used. Often though, we end up writing a similar set of tests
again and again, which can be both tedious and time-consuming.</p>
<p><code>xpectr</code> helps you by generating common
<code>testthat</code> tests. Its goal is <strong>not</strong> to replace
the active thinking process of finding meaningful tests for your
functions, but to help <strong>systematize</strong> and
<strong>ease</strong> that process.</p>
<p>One such example is <code>gxs_function()</code>, which generates
tests for a set of argument value combinations. This allows you to focus
on the selection of argument values to test. Once the tests have been
generated, you can go through each of them to ensure your function is
working as intended and to add relevant tests.</p>
<p>Note: If you comment out the call to <code>gxs_function()</code>, it
is easy to later regenerate the tests. By using a diff tool, you can
check that only the intended changes have been made to the file.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Install the CRAN version with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;xpectr&quot;</span>)</span></code></pre></div>
<p>Install the development version with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)  </span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ludvigolsen/xpectr&quot;</span>)</span></code></pre></div>
</div>
<div id="main-functions" class="section level2">
<h2>Main functions</h2>
<div id="generator-functions" class="section level3">
<h3>Generator functions</h3>
<p>These functions are used to <em>generate expectations</em> (gxs).</p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>gxs_selection()</code></td>
<td align="left">Generates <code>testthat::expect_*</code> statements
from a selection (string of code)</td>
</tr>
<tr class="even">
<td align="left"><code>gxs_function()</code></td>
<td align="left">Generates <code>testthat::expect_*</code> statements
for combinations of supplied argument values</td>
</tr>
</tbody>
</table>
</div>
<div id="functions-for-use-in-tests" class="section level3">
<h3>Functions for use in tests</h3>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strip()</code></td>
<td align="left">Strips strings of non-alphanumeric characters</td>
</tr>
<tr class="even">
<td align="left"><code>strip_msg()</code></td>
<td align="left">Strips side-effect messages of non-alphanumeric
characters and rethrows them</td>
</tr>
<tr class="odd">
<td align="left"><code>suppress_mw()</code></td>
<td align="left">Suppresses warnings and messages</td>
</tr>
<tr class="even">
<td align="left"><code>capture_side_effects()</code></td>
<td align="left">Captures errors, warnings, and messages from an
expression</td>
</tr>
<tr class="odd">
<td align="left"><code>smpl()</code></td>
<td align="left">Samples a vector, factor or data frame with internal
random seed</td>
</tr>
<tr class="even">
<td align="left"><code>simplified_formals()</code></td>
<td align="left">Formats formals as easily testable character
vector</td>
</tr>
<tr class="odd">
<td align="left"><code>element_lengths()</code>,
<code>element_types()</code>, <code>element_classes()</code></td>
<td align="left">Gets the length/type/class of each element</td>
</tr>
<tr class="even">
<td align="left"><code>num_total_elements()</code></td>
<td align="left">Unlists recursively and finds the total number of
elements</td>
</tr>
<tr class="odd">
<td align="left"><code>set_test_seed()</code></td>
<td align="left">Set random seed for unit tests compatible with
<code>R &lt; 3.6.0</code></td>
</tr>
</tbody>
</table>
</div>
<div id="helper-functions" class="section level3">
<h3>Helper functions</h3>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>prepare_insertion()</code></td>
<td align="left">Collapses a vector of expectation strings and adds
indentation</td>
</tr>
<tr class="even">
<td align="left"><code>capture_parse_eval_side_effects()</code></td>
<td align="left">Wraps string in <code>capture_side_effects()</code>
before parsing and evaluating it</td>
</tr>
<tr class="odd">
<td align="left"><code>stop_if()</code>, <code>warn_if()</code>,
<code>message_if()</code></td>
<td align="left">If <code>TRUE</code>, generate error/warning/message
with the supplied message</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="addins" class="section level2">
<h2>Addins</h2>
<table>
<colgroup>
<col width="7%" />
<col width="14%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Addin</th>
<th align="left">Description</th>
<th align="left">Suggested Key Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>Insert Expectations</em>
</br><font size="2"><code>insertExpectationsAddin()</code></font></td>
<td align="left">Generates <code>testthat</code> <code>expect_*</code>
tests from selected code (with <code>gxs_selection()</code>)</td>
<td align="left"><code>Alt+E</code></td>
</tr>
<tr class="even">
<td align="left"><em>Initialize <code>test_that()</code></em>
</br><font size="2"><code>initializeTestthatAddin()</code></font></td>
<td align="left">Inserts <code>testthat::test_that()</code> code</td>
<td align="left"><code>Alt+T</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Initialize <code>gxs_function()</code></em>
</br><font size="2"><code>initializeGXSFunctionAddin()</code></font></td>
<td align="left">Initializes a <code>gxs_function()</code> call with
default values of a function</td>
<td align="left"><code>Alt+F</code></td>
</tr>
<tr class="even">
<td align="left"><em><code>dput()</code> selected</em>
</br><font size="2"><code>dputSelectedAddin()</code></font></td>
<td align="left">Applies <code>dput()</code> to selected code</td>
<td align="left"><code>Alt+D</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Wrap string with <code>paste0()</code></em>
</br><font size="2"><code>wrapStringAddin()</code></font></td>
<td align="left">Splits selected string every n characters and wraps in
<code>paste0()</code> call</td>
<td align="left"><code>Alt+P</code></td>
</tr>
<tr class="even">
<td align="left"><em>Insert <code>checkmate</code>
<code>AssertCollection</code>code</em>
</br><font size="2"><code>assertCollectionAddin()</code></font></td>
<td align="left">Inserts code for initializing and reporting a
<code>checkmate</code> <code>AssertCollection</code></td>
<td align="left"><code>Alt+C</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Navigate To Test File</em>
</br><font size="2"><code>navigateTestFileAddin()</code></font></td>
<td align="left">Navigates to extracted file name and line number. E.g.
select or copy <code>test_x.R:5</code> and it opens
<code>/tests/testthat/test_x.R</code> at line <code>5</code>.</td>
<td align="left"><code>Alt+N</code></td>
</tr>
</tbody>
</table>
</div>
<div id="using-in-packages" class="section level2">
<h2>Using in packages</h2>
<p>Suggestion: Add <code>xpectr</code> in the <code>Suggests</code>
field in the <code>DESCRIPTION</code> file.</p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(xpectr)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Set a seed</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># When R &gt; 3.6.0, it sets sampling.kind to &quot;Rounding&quot; to make</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># tests compatible with previous versions of R</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Some data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>num_vec <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>long_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(LETTERS, letters)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>a_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="st">&#39;a&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="st">&#39;b&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;t&#39;</span>, <span class="st">&#39;y&#39;</span>, <span class="st">&#39;u&#39;</span>),</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="st">&quot;c&quot;</span> <span class="ot">=</span> a_factor,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(a)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># A function with side effects</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">raise =</span> <span class="cn">FALSE</span>){</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Hi! I&#39;m Kevin, your favorite message!&quot;</span>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;G&#39;Day Mam! I&#39;m a warning to the world!&quot;</span>)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Kevin is ma name! Yesss!&quot;</span>)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;Hopefully the whole world will see me :o&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(raise)){</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Lord Evil Error has arrived! Yeehaaa&quot;</span>)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  }</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="st">&quot;the output&quot;</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>}</span></code></pre></div>
<div id="gxs_selection" class="section level3">
<h3>gxs_selection</h3>
<p>Note: <code>gxs_selection()</code> can be used with the
<code>Insert Expectations</code> addin. See
<code>?insertExpectationsAddin</code> for instructions on how to set up
a key command.</p>
<div id="selection-is-a-vector" class="section level4">
<h4>Selection is a vector</h4>
<div id="numeric-vector" class="section level5">
<h5>Numeric vector</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Inspect num_vec</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>num_vec</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Generate expectations</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;num_vec&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">## Testing &#39;num_vec&#39;                                                        ####</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">class</span>(num_vec),</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="st">&quot;integer&quot;</span>,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  num_vec,</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>)</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  num_vec,</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="fu">names</span>(num_vec),</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  <span class="fu">length</span>(num_vec),</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(num_vec)),</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="do">## Finished testing &#39;num_vec&#39;                                               ####</span></span></code></pre></div>
</div>
<div id="factor" class="section level5">
<h5>Factor</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Inspect a_factor</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>a_factor</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; [1] a b c</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Levels: a b c</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Generate expectations</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;a_factor&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">## Testing &#39;a_factor&#39;                                                       ####</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># Testing is factor</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">expect_true</span>(</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">is.factor</span>(a_factor))</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  <span class="fu">as.character</span>(a_factor),</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">names</span>(a_factor),</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="fu">length</span>(a_factor),</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="dv">3</span><span class="dt">L</span>)</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co"># Testing number of levels</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>  <span class="fu">nlevels</span>(a_factor),</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>  <span class="dv">3</span><span class="dt">L</span>)</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co"># Testing levels</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>  <span class="fu">levels</span>(a_factor),</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="do">## Finished testing &#39;a_factor&#39;                                              ####</span></span></code></pre></div>
</div>
<div id="long-vector-sampling" class="section level5">
<h5>Long vector (sampling)</h5>
<p>By default, vectors with more than 30 elements will be sampled. This
adds <code>smpl()</code>, which temporarily sets a seed to make sure the
same elements are returned every time.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Inspect long_vec</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>long_vec</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [20] &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot; &quot;Z&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [39] &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot; &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Generate expectations</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;long_vec&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="do">## Testing &#39;long_vec&#39;                                                       ####</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">class</span>(long_vec),</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="st">&quot;character&quot;</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  long_vec,</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">smpl</span>(long_vec, <span class="at">n =</span> <span class="dv">30</span>),</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;Y&quot;</span>, </span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;p&quot;</span>, </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    <span class="st">&quot;r&quot;</span>, <span class="st">&quot;v&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>  <span class="fu">names</span>(xpectr<span class="sc">::</span><span class="fu">smpl</span>(long_vec, <span class="at">n =</span> <span class="dv">30</span>)),</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>  <span class="fu">length</span>(long_vec),</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>  <span class="dv">52</span><span class="dt">L</span>)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(long_vec)),</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>  <span class="dv">52</span><span class="dt">L</span>)</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="do">## Finished testing &#39;long_vec&#39;                                              ####</span></span></code></pre></div>
</div>
</div>
<div id="selection-is-a-data-frame" class="section level4">
<h4>Selection is a data frame</h4>
<p>Data frames are tested columnwise.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Inspect df</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>df</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; # Groups:   a [3]</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;       a b     c    </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 1     1 t     a    </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 2     2 y     b    </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 3     3 u     c</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Generate expectations</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;df&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="do">## Testing &#39;df&#39;                                                             ####</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="fu">class</span>(df),</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;grouped_df&quot;</span>, <span class="st">&quot;tbl_df&quot;</span>, <span class="st">&quot;tbl&quot;</span>, <span class="st">&quot;data.frame&quot;</span>),</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># Testing column values</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  df[[<span class="st">&quot;a&quot;</span>]],</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  df[[<span class="st">&quot;b&quot;</span>]],</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;t&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>),</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  df[[<span class="st">&quot;c&quot;</span>]],</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="at">class =</span> <span class="st">&quot;factor&quot;</span>))</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># Testing column names</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  <span class="fu">names</span>(df),</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co"># Testing column classes</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">element_classes</span>(df),</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;numeric&quot;</span>, <span class="st">&quot;character&quot;</span>, <span class="st">&quot;factor&quot;</span>),</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co"># Testing column types</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">element_types</span>(df),</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;double&quot;</span>, <span class="st">&quot;character&quot;</span>, <span class="st">&quot;integer&quot;</span>),</span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co"># Testing dimensions</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>  <span class="fu">dim</span>(df),</span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">3</span><span class="dt">L</span>, <span class="dv">3</span><span class="dt">L</span>))</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co"># Testing group keys</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>  <span class="fu">colnames</span>(dplyr<span class="sc">::</span><span class="fu">group_keys</span>(df)),</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>  <span class="st">&quot;a&quot;</span>,</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="do">## Finished testing &#39;df&#39;                                                    ####</span></span></code></pre></div>
</div>
<div id="selection-is-a-function-call-with-side-effects" class="section level4">
<h4>Selection is a function call with side effects</h4>
<p>When the selected code generates an error, warning or message, we can
test those as well. An error is tested with <code>expect_error()</code>,
while messages and warnings are tested as character vectors, to make
sure we catch additional warnings/messages.</p>
<p>When running <code>testthat</code> unit tests on different systems,
they sometimes vary in the use of punctuation and newlines (\n). The
<code>strip()</code> and <code>strip_msg()</code> functions are wrapped
around the side effects to remove non-alphanumeric symbols from the
tested strings. This helps the <code>expect_*</code> functions to ignore
those differences. In cases where such differences are important to
catch, you can set <code>strip = FALSE</code> in
<code>gxs_selection()</code>.</p>
<p>We assign the output of the function to an <code>output_12345</code>
variable, so we don’t have to run it more than once. The number is
randomly generated and is <strong>not</strong> guaranteed to be unique.
<code>suppress_mw()</code> suppresses the messages and warnings.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Inspect fn</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>fn</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; function (raise = FALSE) </span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;     message(&quot;Hi! I&#39;m Kevin, your favorite message!&quot;)</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;     warning(&quot;G&#39;Day Mam! I&#39;m a warning to the world!&quot;)</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt;     message(&quot;Kevin is ma name! Yesss!&quot;)</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt;     warning(&quot;Hopefully the whole world will see me :o&quot;)</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt;     if (isTRUE(raise)) {</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;         stop(&quot;Lord Evil Error has arrived! Yeehaaa&quot;)</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt;     &quot;the output&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Generate expectations</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;fn()&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="do">## Testing &#39;fn()&#39;                                                           ####</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># Assigning side effects</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>side_effects_19148 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">capture_side_effects</span>(<span class="fu">fn</span>(), <span class="at">reset_seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_19148[[<span class="st">&#39;warnings&#39;</span>]]),</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="fu">c</span>(<span class="st">&quot;G&#39;Day Mam! I&#39;m a warning to the world!&quot;</span>, <span class="st">&quot;Hopefully the whole world will see me :o&quot;</span>)),</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_19148[[<span class="st">&#39;messages&#39;</span>]]),</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="fu">c</span>(<span class="st">&quot;Hi! I&#39;m Kevin, your favorite message!</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Kevin is ma name! Yesss!</span><span class="sc">\n</span><span class="st">&quot;</span>)),</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co"># Assigning output</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>output_19148 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">suppress_mw</span>(<span class="fu">fn</span>())</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  <span class="fu">class</span>(output_19148),</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  <span class="st">&quot;character&quot;</span>,</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  output_19148,</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>  output_19148,</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>  <span class="st">&quot;the output&quot;</span>,</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>  <span class="fu">names</span>(output_19148),</span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>  <span class="fu">length</span>(output_19148),</span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(output_19148)),</span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="do">## Finished testing &#39;fn()&#39;                                                  ####</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co"># In case of errors, the warnings and messages aren&#39;t tested</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="fu">gxs_selection</span>(<span class="st">&quot;fn(raise = TRUE)&quot;</span>)</span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="do">## Testing &#39;fn(raise = TRUE)&#39;                                               ####</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">raise =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;Lord Evil Error has arrived! Yeehaaa&quot;</span>),</span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="do">## Finished testing &#39;fn(raise = TRUE)&#39;                                      ####</span></span></code></pre></div>
</div>
</div>
<div id="gxs_function" class="section level3">
<h3>gxs_function</h3>
<p>When testing the inputs to a function, <code>gxs_function()</code>
allows us to quickly specify values to check and generates tests for
each of them.</p>
<p>The first value supplied for an argument is considered the <em>valid
baseline</em> value. For each argument, we create tests for each of the
supplied values, where the other arguments have their baseline
value.</p>
<p>By default, each argument is tested with the <code>NULL</code> object
as well, why we only need to specify it when the baseline value should
be <code>NULL</code>.</p>
<p>It is important that we manually read through the generated tests to
make sure that our function is behaving as intended, and to check if any
important tests are missing.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Define a function with arguments</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">z =</span> <span class="dv">10</span>) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="fu">stop</span>(<span class="st">&quot;&#39;x&#39; &gt; 3&quot;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="cf">if</span> (y <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="fu">warning</span>(<span class="st">&quot;&#39;y&#39;&lt;0&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="cf">if</span> (z <span class="sc">==</span> <span class="dv">10</span>) <span class="fu">message</span>(<span class="st">&quot;&#39;z&#39; was 10!&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  x <span class="sc">+</span> y <span class="sc">+</span> z</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># Create tests for the function</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># Note: We currently need to specify the list of arguments</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># in the function call</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">gxs_function</span>(<span class="at">fn =</span> fn,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>             <span class="at">args_values =</span> <span class="fu">list</span>(</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>               <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="cn">NA</span>),</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>               <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>               <span class="st">&quot;z&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>             ))</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co"># Inserts the following tests:</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="do">## Testing &#39;fn&#39;                                                             ####</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="do">## Initially generated by xpectr</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co"># Testing different combinations of argument values</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co"># Testing fn(x = 2, y = 0, z = 5)</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co"># Assigning output</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>output_19148 <span class="ot">&lt;-</span> <span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">5</span>)</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>  <span class="fu">class</span>(output_19148),</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>  <span class="st">&quot;numeric&quot;</span>,</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>  output_19148,</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;double&quot;</span>)</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>  output_19148,</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>  <span class="dv">7</span>,</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>  <span class="fu">names</span>(output_19148),</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a>  <span class="fu">length</span>(output_19148),</span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(output_19148)),</span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a><span class="co"># Testing fn(x = 4, y = 0, z = 5)</span></span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a><span class="co"># Changed from baseline: x = 4</span></span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb15-62"><a href="#cb15-62" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">5</span>)),</span>
<span id="cb15-63"><a href="#cb15-63" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;&#39;x&#39; &gt; 3&quot;</span>),</span>
<span id="cb15-64"><a href="#cb15-64" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-65"><a href="#cb15-65" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" tabindex="-1"></a><span class="co"># Testing fn(x = NA, y = 0, z = 5)</span></span>
<span id="cb15-67"><a href="#cb15-67" tabindex="-1"></a><span class="co"># Changed from baseline: x = NA</span></span>
<span id="cb15-68"><a href="#cb15-68" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-69"><a href="#cb15-69" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-70"><a href="#cb15-70" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb15-71"><a href="#cb15-71" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="cn">NA</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">5</span>)),</span>
<span id="cb15-72"><a href="#cb15-72" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;missing value where TRUE/FALSE needed&quot;</span>),</span>
<span id="cb15-73"><a href="#cb15-73" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-74"><a href="#cb15-74" tabindex="-1"></a></span>
<span id="cb15-75"><a href="#cb15-75" tabindex="-1"></a><span class="co"># Testing fn(x = NULL, y = 0, z = 5)</span></span>
<span id="cb15-76"><a href="#cb15-76" tabindex="-1"></a><span class="co"># Changed from baseline: x = NULL</span></span>
<span id="cb15-77"><a href="#cb15-77" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-78"><a href="#cb15-78" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-79"><a href="#cb15-79" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb15-80"><a href="#cb15-80" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">5</span>)),</span>
<span id="cb15-81"><a href="#cb15-81" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</span>
<span id="cb15-82"><a href="#cb15-82" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-83"><a href="#cb15-83" tabindex="-1"></a></span>
<span id="cb15-84"><a href="#cb15-84" tabindex="-1"></a><span class="co"># Testing fn(x = 2, y = -1, z = 5)</span></span>
<span id="cb15-85"><a href="#cb15-85" tabindex="-1"></a><span class="co"># Changed from baseline: y = -1</span></span>
<span id="cb15-86"><a href="#cb15-86" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-87"><a href="#cb15-87" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-88"><a href="#cb15-88" tabindex="-1"></a><span class="co"># Assigning side effects</span></span>
<span id="cb15-89"><a href="#cb15-89" tabindex="-1"></a>side_effects_16417 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">capture_side_effects</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">z =</span> <span class="dv">5</span>), <span class="at">reset_seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-90"><a href="#cb15-90" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-91"><a href="#cb15-91" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_16417[[<span class="st">&#39;warnings&#39;</span>]]),</span>
<span id="cb15-92"><a href="#cb15-92" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;&#39;y&#39;&lt;0&quot;</span>),</span>
<span id="cb15-93"><a href="#cb15-93" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-94"><a href="#cb15-94" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-95"><a href="#cb15-95" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_16417[[<span class="st">&#39;messages&#39;</span>]]),</span>
<span id="cb15-96"><a href="#cb15-96" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="fu">character</span>(<span class="dv">0</span>)),</span>
<span id="cb15-97"><a href="#cb15-97" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-98"><a href="#cb15-98" tabindex="-1"></a><span class="co"># Assigning output</span></span>
<span id="cb15-99"><a href="#cb15-99" tabindex="-1"></a>output_16417 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">suppress_mw</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">z =</span> <span class="dv">5</span>))</span>
<span id="cb15-100"><a href="#cb15-100" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb15-101"><a href="#cb15-101" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-102"><a href="#cb15-102" tabindex="-1"></a>  <span class="fu">class</span>(output_16417),</span>
<span id="cb15-103"><a href="#cb15-103" tabindex="-1"></a>  <span class="st">&quot;numeric&quot;</span>,</span>
<span id="cb15-104"><a href="#cb15-104" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-105"><a href="#cb15-105" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb15-106"><a href="#cb15-106" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb15-107"><a href="#cb15-107" tabindex="-1"></a>  output_16417,</span>
<span id="cb15-108"><a href="#cb15-108" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;double&quot;</span>)</span>
<span id="cb15-109"><a href="#cb15-109" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb15-110"><a href="#cb15-110" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-111"><a href="#cb15-111" tabindex="-1"></a>  output_16417,</span>
<span id="cb15-112"><a href="#cb15-112" tabindex="-1"></a>  <span class="dv">6</span>,</span>
<span id="cb15-113"><a href="#cb15-113" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb15-114"><a href="#cb15-114" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb15-115"><a href="#cb15-115" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-116"><a href="#cb15-116" tabindex="-1"></a>  <span class="fu">names</span>(output_16417),</span>
<span id="cb15-117"><a href="#cb15-117" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb15-118"><a href="#cb15-118" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-119"><a href="#cb15-119" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb15-120"><a href="#cb15-120" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-121"><a href="#cb15-121" tabindex="-1"></a>  <span class="fu">length</span>(output_16417),</span>
<span id="cb15-122"><a href="#cb15-122" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-123"><a href="#cb15-123" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb15-124"><a href="#cb15-124" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-125"><a href="#cb15-125" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(output_16417)),</span>
<span id="cb15-126"><a href="#cb15-126" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-127"><a href="#cb15-127" tabindex="-1"></a></span>
<span id="cb15-128"><a href="#cb15-128" tabindex="-1"></a><span class="co"># Testing fn(x = 2, y = NULL, z = 5)</span></span>
<span id="cb15-129"><a href="#cb15-129" tabindex="-1"></a><span class="co"># Changed from baseline: y = NULL</span></span>
<span id="cb15-130"><a href="#cb15-130" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-131"><a href="#cb15-131" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-132"><a href="#cb15-132" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb15-133"><a href="#cb15-133" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">z =</span> <span class="dv">5</span>)),</span>
<span id="cb15-134"><a href="#cb15-134" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</span>
<span id="cb15-135"><a href="#cb15-135" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-136"><a href="#cb15-136" tabindex="-1"></a></span>
<span id="cb15-137"><a href="#cb15-137" tabindex="-1"></a><span class="co"># Testing fn(x = 2, y = 0, z = 10)</span></span>
<span id="cb15-138"><a href="#cb15-138" tabindex="-1"></a><span class="co"># Changed from baseline: z = 10</span></span>
<span id="cb15-139"><a href="#cb15-139" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-140"><a href="#cb15-140" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-141"><a href="#cb15-141" tabindex="-1"></a><span class="co"># Assigning side effects</span></span>
<span id="cb15-142"><a href="#cb15-142" tabindex="-1"></a>side_effects_17365 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">capture_side_effects</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">10</span>), <span class="at">reset_seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-143"><a href="#cb15-143" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-144"><a href="#cb15-144" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_17365[[<span class="st">&#39;warnings&#39;</span>]]),</span>
<span id="cb15-145"><a href="#cb15-145" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="fu">character</span>(<span class="dv">0</span>)),</span>
<span id="cb15-146"><a href="#cb15-146" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-147"><a href="#cb15-147" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-148"><a href="#cb15-148" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(side_effects_17365[[<span class="st">&#39;messages&#39;</span>]]),</span>
<span id="cb15-149"><a href="#cb15-149" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;&#39;z&#39; was 10!</span><span class="sc">\n</span><span class="st">&quot;</span>),</span>
<span id="cb15-150"><a href="#cb15-150" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-151"><a href="#cb15-151" tabindex="-1"></a><span class="co"># Assigning output</span></span>
<span id="cb15-152"><a href="#cb15-152" tabindex="-1"></a>output_17365 <span class="ot">&lt;-</span> xpectr<span class="sc">::</span><span class="fu">suppress_mw</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="dv">10</span>))</span>
<span id="cb15-153"><a href="#cb15-153" tabindex="-1"></a><span class="co"># Testing class</span></span>
<span id="cb15-154"><a href="#cb15-154" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-155"><a href="#cb15-155" tabindex="-1"></a>  <span class="fu">class</span>(output_17365),</span>
<span id="cb15-156"><a href="#cb15-156" tabindex="-1"></a>  <span class="st">&quot;numeric&quot;</span>,</span>
<span id="cb15-157"><a href="#cb15-157" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-158"><a href="#cb15-158" tabindex="-1"></a><span class="co"># Testing type</span></span>
<span id="cb15-159"><a href="#cb15-159" tabindex="-1"></a><span class="fu">expect_type</span>(</span>
<span id="cb15-160"><a href="#cb15-160" tabindex="-1"></a>  output_17365,</span>
<span id="cb15-161"><a href="#cb15-161" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;double&quot;</span>)</span>
<span id="cb15-162"><a href="#cb15-162" tabindex="-1"></a><span class="co"># Testing values</span></span>
<span id="cb15-163"><a href="#cb15-163" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-164"><a href="#cb15-164" tabindex="-1"></a>  output_17365,</span>
<span id="cb15-165"><a href="#cb15-165" tabindex="-1"></a>  <span class="dv">12</span>,</span>
<span id="cb15-166"><a href="#cb15-166" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span>)</span>
<span id="cb15-167"><a href="#cb15-167" tabindex="-1"></a><span class="co"># Testing names</span></span>
<span id="cb15-168"><a href="#cb15-168" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-169"><a href="#cb15-169" tabindex="-1"></a>  <span class="fu">names</span>(output_17365),</span>
<span id="cb15-170"><a href="#cb15-170" tabindex="-1"></a>  <span class="cn">NULL</span>,</span>
<span id="cb15-171"><a href="#cb15-171" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-172"><a href="#cb15-172" tabindex="-1"></a><span class="co"># Testing length</span></span>
<span id="cb15-173"><a href="#cb15-173" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-174"><a href="#cb15-174" tabindex="-1"></a>  <span class="fu">length</span>(output_17365),</span>
<span id="cb15-175"><a href="#cb15-175" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-176"><a href="#cb15-176" tabindex="-1"></a><span class="co"># Testing sum of element lengths</span></span>
<span id="cb15-177"><a href="#cb15-177" tabindex="-1"></a><span class="fu">expect_equal</span>(</span>
<span id="cb15-178"><a href="#cb15-178" tabindex="-1"></a>  <span class="fu">sum</span>(xpectr<span class="sc">::</span><span class="fu">element_lengths</span>(output_17365)),</span>
<span id="cb15-179"><a href="#cb15-179" tabindex="-1"></a>  <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb15-180"><a href="#cb15-180" tabindex="-1"></a></span>
<span id="cb15-181"><a href="#cb15-181" tabindex="-1"></a><span class="co"># Testing fn(x = 2, y = 0, z = NULL)</span></span>
<span id="cb15-182"><a href="#cb15-182" tabindex="-1"></a><span class="co"># Changed from baseline: z = NULL</span></span>
<span id="cb15-183"><a href="#cb15-183" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb15-184"><a href="#cb15-184" tabindex="-1"></a><span class="co"># Testing side effects</span></span>
<span id="cb15-185"><a href="#cb15-185" tabindex="-1"></a><span class="fu">expect_error</span>(</span>
<span id="cb15-186"><a href="#cb15-186" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip_msg</span>(<span class="fu">fn</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">z =</span> <span class="cn">NULL</span>)),</span>
<span id="cb15-187"><a href="#cb15-187" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</span>
<span id="cb15-188"><a href="#cb15-188" tabindex="-1"></a>  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-189"><a href="#cb15-189" tabindex="-1"></a></span>
<span id="cb15-190"><a href="#cb15-190" tabindex="-1"></a><span class="do">## Finished testing &#39;fn&#39;                                                    ####</span></span></code></pre></div>
</div>
<div id="rstudio-addins" class="section level3">
<h3>RStudio Addins</h3>
<p>Below, we present the set of <code>RStudio</code> addins. The
intention is for you to set up key commands for the ones you’d like
access to. Once you get used to using them, they will speed up your
testing process.</p>
<div id="how-to-set-up-a-key-command-in-rstudio" class="section level4">
<h4>How to set up a key command in RStudio</h4>
<p>Here’s a small guide for setting up key comands in
<code>RStudio</code>. We use the <code>Insert Expectations</code> addin
as an example:</p>
<p>After installing the package, go to:</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.</p>
<p>Find <code>&quot;Insert Expectations&quot;</code> and press its field under
<code>Shortcut</code>.</p>
<p>Press desired key command, e.g. <code>Alt+E</code>.</p>
<p>Press <code>Apply</code>.</p>
<p>Press <code>Execute</code>.</p>
</div>
<div id="initializegxsfunctionaddin" class="section level4">
<h4>initializeGXSFunctionAddin</h4>
<p>The <code>initializeGXSFunctionAddin</code> initializes the
<code>gxs_function()</code> call with the argument names and default
values of a selected function. We can then add the argument values and
additional combinations we wish to test. Note, that we don’t need to use
the default values as our baseline values.</p>
<p>The <code>Tip</code> comment tells us to comment out the
<code>gxs_function()</code> call after running it, instead of removing
it. When you change your code, it’s often much quicker to regenerate the
tests than to update them manually. You can then use a diff tool to
check that only the intended changes were made.</p>
<p>The <code>#</code> in the end helps the code be inserted right after
the call to <code>gxs_function()</code>.</p>
<p>Suggested keycommand: <code>Alt+F</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">initializeGXSFunctionAddin</span>(<span class="st">&quot;fn&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># Inserts the following:</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Generate expectations for &#39;fn&#39;</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co"># Tip: comment out the gxs_function() call</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># so it is easy to regenerate the tests</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>xpectr<span class="sc">::</span><span class="fu">gxs_function</span>(</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="at">fn =</span> fn,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="at">args_values =</span> <span class="fu">list</span>(</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>    <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(),</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(),</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>    <span class="st">&quot;z&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">10</span>)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  ),</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="at">identation =</span> <span class="dv">2</span>,</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  <span class="at">copy_env =</span> <span class="cn">FALSE</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>)</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
</div>
<div id="wrapstringaddin" class="section level4">
<h4>wrapStringAddin</h4>
<p>The <code>wrapStringAddin</code> splits long strings and wraps them
with <code>paste0()</code>.</p>
<p>Suggested keycommand: <code>Alt+P</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">wrapStringAddin</span>(<span class="st">&quot;This is a fairly long sentence that we would very very much like to make shorter in our test file!&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># Inserts the following:</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;This is a fairly long sentence that we would very very much &quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>       <span class="st">&quot;like to make shorter in our test file!&quot;</span>)</span></code></pre></div>
</div>
<div id="initializetestthataddin" class="section level4">
<h4>initializeTestthatAddin</h4>
<p>Suggested keycommand: <code>Alt+T</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">initializeTestthatAddin</span>()</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># Inserts the following:</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;testing ...()&quot;</span>, {</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  xpectr<span class="sc">::</span><span class="fu">set_test_seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="co"># ...</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="assertcollectionaddin" class="section level4">
<h4>assertCollectionAddin</h4>
<p>Suggested keycommand: <code>Alt+C</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">assertCollectionAddin</span>()</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># Inserts the following:</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># Check arguments ####</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>assert_collection <span class="ot">&lt;-</span> checkmate<span class="sc">::</span><span class="fu">makeAssertCollection</span>()</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># checkmate::assert_ , add = assert_collection)</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>checkmate<span class="sc">::</span><span class="fu">reportAssertions</span>(assert_collection)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co"># End of argument checks ####</span></span></code></pre></div>
</div>
<div id="dputselectedaddin" class="section level4">
<h4>dputSelectedAddin</h4>
<p>Suggested keycommand: <code>Alt+D</code></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">dputSelectedAddin</span>(<span class="st">&quot;v&quot;</span>)  <span class="co"># &quot;v&quot; is the selected code</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># Inserts the following:</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="navigatetestfileaddin" class="section level4">
<h4>navigateTestFileAddin</h4>
<p>Suggested keycommand: <code>Alt+N</code></p>
<p>A common work process in package development is to run
<code>Ctrl/Cmd+Shift+L</code>, which runs all <code>testthat</code>
tests in <code>/tests/testthat/</code> in the <code>Build</code>
pane.</p>
<p>When a test fails, a message like the following is printed:
<code>test_x.R:15: failure: x works</code>.</p>
<p>If we then copy the <code>test_x.R:15:</code> part to our clipboard
and run <code>navigateTestFileAddin()</code>, it will open the
<code>test_x.R</code> file and place the cursor at line
<code>15</code>.</p>
<p>A service like <code>Travis CI</code> indicate the failed test with
<code>(@test_x.R#15)</code>. The addin therefore also works with
<code>test_x.R#15</code>. If you have additional formats you would like
to request, simply open an issue.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
