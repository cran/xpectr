<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ludvig Renbo Olsen" />

<meta name="date" content="2020-06-18" />

<title>README for xpectr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
  p.abstract{
    text-align: center;
    font-weight: bold;
  }
  div.abstract{
    margin: auto;
    width: 90%;
  }
</style>


<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>
<style type="text/css">h1 {
font-size:190%;
padding-top:20px;
}
hr {
border-style: solid;
border: none;
border-top: 0.5px solid #777;
margin: 28px 0;
}
img {
margin-top: 20px;
margin-bottom: 20px;
}
p {
padding-bottom:7px;
}
</style>




</head>

<body>




<h1 class="title toc-ignore">README for xpectr</h1>
<h4 class="author">Ludvig Renbo Olsen</h4>
<h4 class="date">2020-06-18</h4>
<div class="abstract">
<p class="abstract">Abstract</p>
This vignette is an introduction to the <code>xpectr</code> package. <code>xpectr</code> provides a set of utilities and RStudio addins for generating tests for <code>testthat</code> unit testing.  <br />
 <br />
Contact author at <a href="mailto:r-pkgs@ludvigolsen.dk" class="email">r-pkgs@ludvigolsen.dk</a>  <br />
 <br />
</div>


<div id="TOC">
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#main-functions">Main functions</a><ul>
<li><a href="#generator-functions">Generator functions</a></li>
<li><a href="#functions-for-use-in-tests">Functions for use in tests</a></li>
<li><a href="#helper-functions">Helper functions</a></li>
</ul></li>
<li><a href="#addins">Addins</a></li>
<li><a href="#using-in-packages">Using in packages</a></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#gxs_selection">gxs_selection</a></li>
<li><a href="#gxs_function">gxs_function</a></li>
<li><a href="#rstudio-addins">RStudio Addins</a></li>
</ul></li>
</ul>
</div>

<p>When developing R packages, it’s good practice to build a good set of unit tests that will notify you when something breaks in the future. For this, the <a href="https://testthat.r-lib.org/"><code>testthat</code></a> package is commonly used. Often though, we end up writing a similar set of tests again and again, which can be both tedious and time-consuming.</p>
<p><code>xpectr</code> helps you by generating common <code>testthat</code> tests. Its goal is <strong>not</strong> to replace the active thinking process of finding meaningful tests for your functions, but to help <strong>systematize</strong> and <strong>ease</strong> that process.</p>
<p>One such example is <code>gxs_function()</code>, which generates tests for a set of argument value combinations. This allows you to focus on the selection of argument values to test. Once the tests have been generated, you can go through each of them to ensure your function is working as intended and to add relevant tests.</p>
<p>Note: If you comment out the call to <code>gxs_function()</code>, it is easy to later regenerate the tests. By using a diff tool, you can check that only the intended changes have been made to the file.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Install the CRAN version with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;xpectr&quot;</span>)</a></code></pre></div>
<p>Install the development version with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages(&quot;devtools&quot;)  </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ludvigolsen/xpectr&quot;</span>)</a></code></pre></div>
</div>
<div id="main-functions" class="section level2">
<h2>Main functions</h2>
<div id="generator-functions" class="section level3">
<h3>Generator functions</h3>
<p>These functions are used to <em>generate expectations</em> (gxs).</p>
<table>
<colgroup>
<col width="43%"></col>
<col width="56%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>gxs_selection()</code></td>
<td align="left">Generates <code>testthat::expect_*</code> statements from a selection (string of code)</td>
</tr>
<tr class="even">
<td align="left"><code>gxs_function()</code></td>
<td align="left">Generates <code>testthat::expect_*</code> statements for combinations of supplied argument values</td>
</tr>
</tbody>
</table>
</div>
<div id="functions-for-use-in-tests" class="section level3">
<h3>Functions for use in tests</h3>
<table>
<colgroup>
<col width="43%"></col>
<col width="56%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strip()</code></td>
<td align="left">Strips strings of non-alphanumeric characters</td>
</tr>
<tr class="even">
<td align="left"><code>strip_msg()</code></td>
<td align="left">Strips side-effect messages of non-alphanumeric characters and rethrows them</td>
</tr>
<tr class="odd">
<td align="left"><code>suppress_mw()</code></td>
<td align="left">Suppresses warnings and messages</td>
</tr>
<tr class="even">
<td align="left"><code>capture_side_effects()</code></td>
<td align="left">Captures errors, warnings, and messages from an expression</td>
</tr>
<tr class="odd">
<td align="left"><code>smpl()</code></td>
<td align="left">Samples a vector, factor or data frame with internal random seed</td>
</tr>
<tr class="even">
<td align="left"><code>simplified_formals()</code></td>
<td align="left">Formats formals as easily testable character vector</td>
</tr>
<tr class="odd">
<td align="left"><code>element_lengths()</code>, <code>element_types()</code>, <code>element_classes()</code></td>
<td align="left">Gets the length/type/class of each element</td>
</tr>
<tr class="even">
<td align="left"><code>num_total_elements()</code></td>
<td align="left">Unlists recursively and finds the total number of elements</td>
</tr>
<tr class="odd">
<td align="left"><code>set_test_seed()</code></td>
<td align="left">Set random seed for unit tests compatible with <code>R &lt; 3.6.0</code></td>
</tr>
</tbody>
</table>
</div>
<div id="helper-functions" class="section level3">
<h3>Helper functions</h3>
<table>
<colgroup>
<col width="43%"></col>
<col width="56%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>prepare_insertion()</code></td>
<td align="left">Collapses a vector of expectation strings and adds indentation</td>
</tr>
<tr class="even">
<td align="left"><code>capture_parse_eval_side_effects()</code></td>
<td align="left">Wraps string in <code>capture_side_effects()</code> before parsing and evaluating it</td>
</tr>
<tr class="odd">
<td align="left"><code>stop_if()</code>, <code>warn_if()</code>, <code>message_if()</code></td>
<td align="left">If <code>TRUE</code>, generate error/warning/message with the supplied message</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="addins" class="section level2">
<h2>Addins</h2>
<table>
<colgroup>
<col width="7%"></col>
<col width="14%"></col>
<col width="77%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Addin</th>
<th align="left">Description</th>
<th align="left">Suggested Key Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>Insert Expectations</em> </br><font size="2"><code>insertExpectationsAddin()</code></font></td>
<td align="left">Generates <code>testthat</code> <code>expect_*</code> tests from selected code (with <code>gxs_selection()</code>)</td>
<td align="left"><code>Alt+E</code></td>
</tr>
<tr class="even">
<td align="left"><em>Initialize <code>test_that()</code></em> </br><font size="2"><code>initializeTestthatAddin()</code></font></td>
<td align="left">Inserts <code>testthat::test_that()</code> code</td>
<td align="left"><code>Alt+T</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Initialize <code>gxs_function()</code></em> </br><font size="2"><code>initializeGXSFunctionAddin()</code></font></td>
<td align="left">Initializes a <code>gxs_function()</code> call with default values of a function</td>
<td align="left"><code>Alt+F</code></td>
</tr>
<tr class="even">
<td align="left"><em><code>dput()</code> selected</em> </br><font size="2"><code>dputSelectedAddin()</code></font></td>
<td align="left">Applies <code>dput()</code> to selected code</td>
<td align="left"><code>Alt+D</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Wrap string with <code>paste0()</code></em> </br><font size="2"><code>wrapStringAddin()</code></font></td>
<td align="left">Splits selected string every n characters and wraps in <code>paste0()</code> call</td>
<td align="left"><code>Alt+P</code></td>
</tr>
<tr class="even">
<td align="left"><em>Insert <code>checkmate</code> <code>AssertCollection</code>code</em> </br><font size="2"><code>assertCollectionAddin()</code></font></td>
<td align="left">Inserts code for initializing and reporting a <code>checkmate</code> <code>AssertCollection</code></td>
<td align="left"><code>Alt+C</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Navigate To Test File</em> </br><font size="2"><code>navigateTestFileAddin()</code></font></td>
<td align="left">Navigates to extracted file name and line number. E.g. select or copy <code>test_x.R:5</code> and it opens <code>/tests/testthat/test_x.R</code> at line <code>5</code>.</td>
<td align="left"><code>Alt+N</code></td>
</tr>
</tbody>
</table>
</div>
<div id="using-in-packages" class="section level2">
<h2>Using in packages</h2>
<p>Suggestion: Add <code>xpectr</code> in the <code>Suggests</code> field in the <code>DESCRIPTION</code> file.</p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(xpectr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(testthat)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Set a seed</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># When R &gt; 3.6.0, it sets sampling.kind to &quot;Rounding&quot; to make</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># tests compatible with previous versions of R</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Some data</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">num_vec &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">long_vec &lt;-<span class="st"> </span><span class="kw">c</span>(LETTERS, letters)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">a_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="st">'a'</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="st">'b'</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">'t'</span>, <span class="st">'y'</span>, <span class="st">'u'</span>),</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="st">&quot;c&quot;</span> =<span class="st"> </span>a_factor,</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(a)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co"># A function with side effects</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">fn &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">raise =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  <span class="kw">message</span>(<span class="st">&quot;Hi! I'm Kevin, your favorite message!&quot;</span>)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  <span class="kw">warning</span>(<span class="st">&quot;G'Day Mam! I'm a warning to the world!&quot;</span>)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  <span class="kw">message</span>(<span class="st">&quot;Kevin is ma name! Yesss!&quot;</span>)</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  <span class="kw">warning</span>(<span class="st">&quot;Hopefully the whole world will see me :o&quot;</span>)</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  <span class="cf">if</span> (<span class="kw">isTRUE</span>(raise)){</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">    <span class="kw">stop</span>(<span class="st">&quot;Lord Evil Error has arrived! Yeehaaa&quot;</span>)</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">  <span class="st">&quot;the output&quot;</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">}</a></code></pre></div>
<div id="gxs_selection" class="section level3">
<h3>gxs_selection</h3>
<p>Note: <code>gxs_selection()</code> can be used with the <code>Insert Expectations</code> addin. See <code>?insertExpectationsAddin</code> for instructions on how to set up a key command.</p>
<div id="selection-is-a-vector" class="section level4">
<h4>Selection is a vector</h4>
<div id="numeric-vector" class="section level5">
<h5>Numeric vector</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Inspect num_vec</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">num_vec</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Generate expectations</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">gxs_selection</span>(<span class="st">&quot;num_vec&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">## Testing 'num_vec'                                                        ####</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  <span class="kw">class</span>(num_vec),</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="st">&quot;integer&quot;</span>,</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  num_vec,</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  <span class="dt">type =</span> <span class="st">&quot;integer&quot;</span>)</a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  num_vec,</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  <span class="dt">tolerance =</span> <span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  <span class="kw">names</span>(num_vec),</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb6-30" data-line-number="30">  <span class="kw">length</span>(num_vec),</a>
<a class="sourceLine" id="cb6-31" data-line-number="31">  10L)</a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb6-34" data-line-number="34">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(num_vec)),</a>
<a class="sourceLine" id="cb6-35" data-line-number="35">  10L)</a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">## Finished testing 'num_vec'                                               ####</span></a></code></pre></div>
</div>
<div id="factor" class="section level5">
<h5>Factor</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Inspect a_factor</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">a_factor</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; [1] a b c</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; Levels: a b c</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Generate expectations</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">gxs_selection</span>(<span class="st">&quot;a_factor&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">## Testing 'a_factor'                                                       ####</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># Testing is factor</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="kw">expect_true</span>(</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">  <span class="kw">is.factor</span>(a_factor))</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">  <span class="kw">as.character</span>(a_factor),</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">  <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">  <span class="kw">names</span>(a_factor),</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb8-24" data-line-number="24">  <span class="kw">length</span>(a_factor),</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">  3L)</a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co"># Testing number of levels</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb8-28" data-line-number="28">  <span class="kw">nlevels</span>(a_factor),</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">  3L)</a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co"># Testing levels</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">  <span class="kw">levels</span>(a_factor),</a>
<a class="sourceLine" id="cb8-33" data-line-number="33">  <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</a>
<a class="sourceLine" id="cb8-34" data-line-number="34">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">## Finished testing 'a_factor'                                              ####</span></a></code></pre></div>
</div>
<div id="long-vector-sampling" class="section level5">
<h5>Long vector (sampling)</h5>
<p>By default, vectors with more than 30 elements will be sampled. This adds <code>smpl()</code>, which temporarily sets a seed to make sure the same elements are returned every time.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Inspect long_vec</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">long_vec</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot;</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [20] &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot; &quot;Z&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot;</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; [39] &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot; &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Generate expectations</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">gxs_selection</span>(<span class="st">&quot;long_vec&quot;</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">## Testing 'long_vec'                                                       ####</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">  <span class="kw">class</span>(long_vec),</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">  <span class="st">&quot;character&quot;</span>,</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">  long_vec,</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">  <span class="dt">type =</span> <span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">  xpectr<span class="op">::</span><span class="kw">smpl</span>(long_vec, <span class="dt">n =</span> <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">  <span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;Y&quot;</span>, </a>
<a class="sourceLine" id="cb10-22" data-line-number="22">    <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;p&quot;</span>, </a>
<a class="sourceLine" id="cb10-23" data-line-number="23">    <span class="st">&quot;r&quot;</span>, <span class="st">&quot;v&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb10-27" data-line-number="27">  <span class="kw">names</span>(xpectr<span class="op">::</span><span class="kw">smpl</span>(long_vec, <span class="dt">n =</span> <span class="dv">30</span>)),</a>
<a class="sourceLine" id="cb10-28" data-line-number="28">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb10-29" data-line-number="29">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">  <span class="kw">length</span>(long_vec),</a>
<a class="sourceLine" id="cb10-33" data-line-number="33">  52L)</a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb10-36" data-line-number="36">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(long_vec)),</a>
<a class="sourceLine" id="cb10-37" data-line-number="37">  52L)</a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">## Finished testing 'long_vec'                                              ####</span></a></code></pre></div>
</div>
</div>
<div id="selection-is-a-data-frame" class="section level4">
<h4>Selection is a data frame</h4>
<p>Data frames are tested columnwise.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Inspect df</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # Groups:   a [3]</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;       a b     c    </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; 1     1 t     a    </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; 2     2 y     b    </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; 3     3 u     c</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Generate expectations</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">gxs_selection</span>(<span class="st">&quot;df&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">## Testing 'df'                                                             ####</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  <span class="kw">class</span>(df),</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">  <span class="kw">c</span>(<span class="st">&quot;grouped_df&quot;</span>, <span class="st">&quot;tbl_df&quot;</span>, <span class="st">&quot;tbl&quot;</span>, <span class="st">&quot;data.frame&quot;</span>),</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co"># Testing column values</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  df[[<span class="st">&quot;a&quot;</span>]],</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">  <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">  <span class="dt">tolerance =</span> <span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">  df[[<span class="st">&quot;b&quot;</span>]],</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">  <span class="kw">c</span>(<span class="st">&quot;t&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;u&quot;</span>),</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">  df[[<span class="st">&quot;c&quot;</span>]],</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">  <span class="kw">structure</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.Label =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="dt">class =</span> <span class="st">&quot;factor&quot;</span>))</a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co"># Testing column names</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">  <span class="kw">names</span>(df),</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">  <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co"># Testing column classes</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-33" data-line-number="33">  xpectr<span class="op">::</span><span class="kw">element_classes</span>(df),</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">  <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>, <span class="st">&quot;character&quot;</span>, <span class="st">&quot;factor&quot;</span>),</a>
<a class="sourceLine" id="cb12-35" data-line-number="35">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co"># Testing column types</span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-38" data-line-number="38">  xpectr<span class="op">::</span><span class="kw">element_types</span>(df),</a>
<a class="sourceLine" id="cb12-39" data-line-number="39">  <span class="kw">c</span>(<span class="st">&quot;double&quot;</span>, <span class="st">&quot;character&quot;</span>, <span class="st">&quot;integer&quot;</span>),</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-41" data-line-number="41"><span class="co"># Testing dimensions</span></a>
<a class="sourceLine" id="cb12-42" data-line-number="42"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-43" data-line-number="43">  <span class="kw">dim</span>(df),</a>
<a class="sourceLine" id="cb12-44" data-line-number="44">  <span class="kw">c</span>(3L, 3L))</a>
<a class="sourceLine" id="cb12-45" data-line-number="45"><span class="co"># Testing group keys</span></a>
<a class="sourceLine" id="cb12-46" data-line-number="46"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb12-47" data-line-number="47">  <span class="kw">colnames</span>(dplyr<span class="op">::</span><span class="kw">group_keys</span>(df)),</a>
<a class="sourceLine" id="cb12-48" data-line-number="48">  <span class="st">&quot;a&quot;</span>,</a>
<a class="sourceLine" id="cb12-49" data-line-number="49">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-50" data-line-number="50"><span class="co">## Finished testing 'df'                                                    ####</span></a></code></pre></div>
</div>
<div id="selection-is-a-function-call-with-side-effects" class="section level4">
<h4>Selection is a function call with side effects</h4>
<p>When the selected code generates an error, warning or message, we can test those as well. An error is tested with <code>expect_error()</code>, while messages and warnings are tested as character vectors, to make sure we catch additional warnings/messages.</p>
<p>When running <code>testthat</code> unit tests on different systems, they sometimes vary in the use of punctuation and newlines (\n). The <code>strip()</code> and <code>strip_msg()</code> functions are wrapped around the side effects to remove non-alphanumeric symbols from the tested strings. This helps the <code>expect_*</code> functions to ignore those differences. In cases where such differences are important to catch, you can set <code>strip = FALSE</code> in <code>gxs_selection()</code>.</p>
<p>We assign the output of the function to an <code>output_12345</code> variable, so we don’t have to run it more than once. The number is randomly generated and is <strong>not</strong> guaranteed to be unique. <code>suppress_mw()</code> suppresses the messages and warnings.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Inspect fn</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">fn</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; function(raise = FALSE){</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt;   message(&quot;Hi! I'm Kevin, your favorite message!&quot;)</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt;   warning(&quot;G'Day Mam! I'm a warning to the world!&quot;)</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt;   message(&quot;Kevin is ma name! Yesss!&quot;)</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt;   warning(&quot;Hopefully the whole world will see me :o&quot;)</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;   if (isTRUE(raise)){</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;     stop(&quot;Lord Evil Error has arrived! Yeehaaa&quot;)</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;   }</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;   &quot;the output&quot;</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; }</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Generate expectations</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">gxs_selection</span>(<span class="st">&quot;fn()&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">## Testing 'fn()'                                                           ####</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co"># Assigning side effects</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">side_effects_<span class="dv">19148</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">capture_side_effects</span>(<span class="kw">fn</span>(), <span class="dt">reset_seed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">19148</span>[[<span class="st">'warnings'</span>]]),</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="kw">c</span>(<span class="st">&quot;G'Day Mam! I'm a warning to the world!&quot;</span>, <span class="st">&quot;Hopefully the whole world will see me :o&quot;</span>)),</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">19148</span>[[<span class="st">'messages'</span>]]),</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="kw">c</span>(<span class="st">&quot;Hi! I'm Kevin, your favorite message!</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Kevin is ma name! Yesss!</span><span class="ch">\n</span><span class="st">&quot;</span>)),</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co"># Assigning output</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">output_<span class="dv">19148</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">suppress_mw</span>(<span class="kw">fn</span>())</a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">  <span class="kw">class</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">  <span class="st">&quot;character&quot;</span>,</a>
<a class="sourceLine" id="cb14-26" data-line-number="26">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb14-29" data-line-number="29">  output_<span class="dv">19148</span>,</a>
<a class="sourceLine" id="cb14-30" data-line-number="30">  <span class="dt">type =</span> <span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-33" data-line-number="33">  output_<span class="dv">19148</span>,</a>
<a class="sourceLine" id="cb14-34" data-line-number="34">  <span class="st">&quot;the output&quot;</span>,</a>
<a class="sourceLine" id="cb14-35" data-line-number="35">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-38" data-line-number="38">  <span class="kw">names</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb14-39" data-line-number="39">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb14-40" data-line-number="40">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-41" data-line-number="41"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb14-42" data-line-number="42"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-43" data-line-number="43">  <span class="kw">length</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb14-44" data-line-number="44">  1L)</a>
<a class="sourceLine" id="cb14-45" data-line-number="45"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb14-46" data-line-number="46"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb14-47" data-line-number="47">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(output_<span class="dv">19148</span>)),</a>
<a class="sourceLine" id="cb14-48" data-line-number="48">  1L)</a>
<a class="sourceLine" id="cb14-49" data-line-number="49"><span class="co">## Finished testing 'fn()'                                                  ####</span></a>
<a class="sourceLine" id="cb14-50" data-line-number="50"></a>
<a class="sourceLine" id="cb14-51" data-line-number="51"><span class="co"># In case of errors, the warnings and messages aren't tested</span></a>
<a class="sourceLine" id="cb14-52" data-line-number="52"></a>
<a class="sourceLine" id="cb14-53" data-line-number="53"><span class="kw">gxs_selection</span>(<span class="st">&quot;fn(raise = TRUE)&quot;</span>)</a>
<a class="sourceLine" id="cb14-54" data-line-number="54"></a>
<a class="sourceLine" id="cb14-55" data-line-number="55"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb14-56" data-line-number="56"></a>
<a class="sourceLine" id="cb14-57" data-line-number="57"><span class="co">## Testing 'fn(raise = TRUE)'                                               ####</span></a>
<a class="sourceLine" id="cb14-58" data-line-number="58"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb14-59" data-line-number="59">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb14-60" data-line-number="60"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb14-61" data-line-number="61"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb14-62" data-line-number="62">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">raise =</span> <span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb14-63" data-line-number="63">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;Lord Evil Error has arrived! Yeehaaa&quot;</span>),</a>
<a class="sourceLine" id="cb14-64" data-line-number="64">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-65" data-line-number="65"><span class="co">## Finished testing 'fn(raise = TRUE)'                                      ####</span></a></code></pre></div>
</div>
</div>
<div id="gxs_function" class="section level3">
<h3>gxs_function</h3>
<p>When testing the inputs to a function, <code>gxs_function()</code> allows us to quickly specify values to check and generates tests for each of them.</p>
<p>The first value supplied for an argument is considered the <em>valid baseline</em> value. For each argument, we create tests for each of the supplied values, where the other arguments have their baseline value.</p>
<p>By default, each argument is tested with the <code>NULL</code> object as well, why we only need to specify it when the baseline value should be <code>NULL</code>.</p>
<p>It is important that we manually read through the generated tests to make sure that our function is behaving as intended, and to check if any important tests are missing.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Define a function with arguments</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">fn &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">z =</span> <span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="cf">if</span> (x <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>) <span class="kw">stop</span>(<span class="st">&quot;'x' &gt; 3&quot;</span>)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">warning</span>(<span class="st">&quot;'y'&lt;0&quot;</span>)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="cf">if</span> (z <span class="op">==</span><span class="st"> </span><span class="dv">10</span>) <span class="kw">message</span>(<span class="st">&quot;'z' was 10!&quot;</span>)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  x <span class="op">+</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span>z</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co"># Create tests for the function</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co"># Note: We currently need to specify the list of arguments</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co"># in the function call</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="kw">gxs_function</span>(<span class="dt">fn =</span> fn,</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">             <span class="dt">args_values =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">               <span class="st">&quot;x&quot;</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">               <span class="st">&quot;y&quot;</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">               <span class="st">&quot;z&quot;</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">             ))</a>
<a class="sourceLine" id="cb15-18" data-line-number="18"></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co"># Inserts the following tests:</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">## Testing 'fn'                                                             ####</span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">## Initially generated by xpectr</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co"># Testing different combinations of argument values</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co"># Testing fn(x = 2, y = 0, z = 5)</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co"># Assigning output</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28">output_<span class="dv">19148</span> &lt;-<span class="st"> </span><span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-31" data-line-number="31">  <span class="kw">class</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb15-32" data-line-number="32">  <span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb15-33" data-line-number="33">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb15-36" data-line-number="36">  output_<span class="dv">19148</span>,</a>
<a class="sourceLine" id="cb15-37" data-line-number="37">  <span class="dt">type =</span> <span class="st">&quot;double&quot;</span>)</a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-40" data-line-number="40">  output_<span class="dv">19148</span>,</a>
<a class="sourceLine" id="cb15-41" data-line-number="41">  <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb15-42" data-line-number="42">  <span class="dt">tolerance =</span> <span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb15-43" data-line-number="43"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb15-44" data-line-number="44"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-45" data-line-number="45">  <span class="kw">names</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb15-46" data-line-number="46">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb15-47" data-line-number="47">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-48" data-line-number="48"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb15-49" data-line-number="49"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-50" data-line-number="50">  <span class="kw">length</span>(output_<span class="dv">19148</span>),</a>
<a class="sourceLine" id="cb15-51" data-line-number="51">  1L)</a>
<a class="sourceLine" id="cb15-52" data-line-number="52"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb15-53" data-line-number="53"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-54" data-line-number="54">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(output_<span class="dv">19148</span>)),</a>
<a class="sourceLine" id="cb15-55" data-line-number="55">  1L)</a>
<a class="sourceLine" id="cb15-56" data-line-number="56"></a>
<a class="sourceLine" id="cb15-57" data-line-number="57"><span class="co"># Testing fn(x = 4, y = 0, z = 5)</span></a>
<a class="sourceLine" id="cb15-58" data-line-number="58"><span class="co"># Changed from baseline: x = 4</span></a>
<a class="sourceLine" id="cb15-59" data-line-number="59">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-60" data-line-number="60"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-61" data-line-number="61"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb15-62" data-line-number="62">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb15-63" data-line-number="63">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;'x' &gt; 3&quot;</span>),</a>
<a class="sourceLine" id="cb15-64" data-line-number="64">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-65" data-line-number="65"></a>
<a class="sourceLine" id="cb15-66" data-line-number="66"><span class="co"># Testing fn(x = NA, y = 0, z = 5)</span></a>
<a class="sourceLine" id="cb15-67" data-line-number="67"><span class="co"># Changed from baseline: x = NA</span></a>
<a class="sourceLine" id="cb15-68" data-line-number="68">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-69" data-line-number="69"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-70" data-line-number="70"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb15-71" data-line-number="71">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="ot">NA</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb15-72" data-line-number="72">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;missing value where TRUE/FALSE needed&quot;</span>),</a>
<a class="sourceLine" id="cb15-73" data-line-number="73">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-74" data-line-number="74"></a>
<a class="sourceLine" id="cb15-75" data-line-number="75"><span class="co"># Testing fn(x = NULL, y = 0, z = 5)</span></a>
<a class="sourceLine" id="cb15-76" data-line-number="76"><span class="co"># Changed from baseline: x = NULL</span></a>
<a class="sourceLine" id="cb15-77" data-line-number="77">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-78" data-line-number="78"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-79" data-line-number="79"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb15-80" data-line-number="80">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb15-81" data-line-number="81">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</a>
<a class="sourceLine" id="cb15-82" data-line-number="82">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-83" data-line-number="83"></a>
<a class="sourceLine" id="cb15-84" data-line-number="84"><span class="co"># Testing fn(x = 2, y = -1, z = 5)</span></a>
<a class="sourceLine" id="cb15-85" data-line-number="85"><span class="co"># Changed from baseline: y = -1</span></a>
<a class="sourceLine" id="cb15-86" data-line-number="86">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-87" data-line-number="87"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-88" data-line-number="88"><span class="co"># Assigning side effects</span></a>
<a class="sourceLine" id="cb15-89" data-line-number="89">side_effects_<span class="dv">16417</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">capture_side_effects</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">-1</span>, <span class="dt">z =</span> <span class="dv">5</span>), <span class="dt">reset_seed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-90" data-line-number="90"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-91" data-line-number="91">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">16417</span>[[<span class="st">'warnings'</span>]]),</a>
<a class="sourceLine" id="cb15-92" data-line-number="92">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;'y'&lt;0&quot;</span>),</a>
<a class="sourceLine" id="cb15-93" data-line-number="93">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-94" data-line-number="94"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-95" data-line-number="95">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">16417</span>[[<span class="st">'messages'</span>]]),</a>
<a class="sourceLine" id="cb15-96" data-line-number="96">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="kw">character</span>(<span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb15-97" data-line-number="97">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-98" data-line-number="98"><span class="co"># Assigning output</span></a>
<a class="sourceLine" id="cb15-99" data-line-number="99">output_<span class="dv">16417</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">suppress_mw</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">-1</span>, <span class="dt">z =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb15-100" data-line-number="100"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb15-101" data-line-number="101"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-102" data-line-number="102">  <span class="kw">class</span>(output_<span class="dv">16417</span>),</a>
<a class="sourceLine" id="cb15-103" data-line-number="103">  <span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb15-104" data-line-number="104">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-105" data-line-number="105"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb15-106" data-line-number="106"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb15-107" data-line-number="107">  output_<span class="dv">16417</span>,</a>
<a class="sourceLine" id="cb15-108" data-line-number="108">  <span class="dt">type =</span> <span class="st">&quot;double&quot;</span>)</a>
<a class="sourceLine" id="cb15-109" data-line-number="109"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb15-110" data-line-number="110"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-111" data-line-number="111">  output_<span class="dv">16417</span>,</a>
<a class="sourceLine" id="cb15-112" data-line-number="112">  <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb15-113" data-line-number="113">  <span class="dt">tolerance =</span> <span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb15-114" data-line-number="114"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb15-115" data-line-number="115"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-116" data-line-number="116">  <span class="kw">names</span>(output_<span class="dv">16417</span>),</a>
<a class="sourceLine" id="cb15-117" data-line-number="117">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb15-118" data-line-number="118">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-119" data-line-number="119"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb15-120" data-line-number="120"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-121" data-line-number="121">  <span class="kw">length</span>(output_<span class="dv">16417</span>),</a>
<a class="sourceLine" id="cb15-122" data-line-number="122">  1L)</a>
<a class="sourceLine" id="cb15-123" data-line-number="123"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb15-124" data-line-number="124"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-125" data-line-number="125">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(output_<span class="dv">16417</span>)),</a>
<a class="sourceLine" id="cb15-126" data-line-number="126">  1L)</a>
<a class="sourceLine" id="cb15-127" data-line-number="127"></a>
<a class="sourceLine" id="cb15-128" data-line-number="128"><span class="co"># Testing fn(x = 2, y = NULL, z = 5)</span></a>
<a class="sourceLine" id="cb15-129" data-line-number="129"><span class="co"># Changed from baseline: y = NULL</span></a>
<a class="sourceLine" id="cb15-130" data-line-number="130">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-131" data-line-number="131"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-132" data-line-number="132"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb15-133" data-line-number="133">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">z =</span> <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb15-134" data-line-number="134">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</a>
<a class="sourceLine" id="cb15-135" data-line-number="135">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-136" data-line-number="136"></a>
<a class="sourceLine" id="cb15-137" data-line-number="137"><span class="co"># Testing fn(x = 2, y = 0, z = 10)</span></a>
<a class="sourceLine" id="cb15-138" data-line-number="138"><span class="co"># Changed from baseline: z = 10</span></a>
<a class="sourceLine" id="cb15-139" data-line-number="139">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-140" data-line-number="140"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-141" data-line-number="141"><span class="co"># Assigning side effects</span></a>
<a class="sourceLine" id="cb15-142" data-line-number="142">side_effects_<span class="dv">17365</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">capture_side_effects</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">10</span>), <span class="dt">reset_seed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-143" data-line-number="143"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-144" data-line-number="144">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">17365</span>[[<span class="st">'warnings'</span>]]),</a>
<a class="sourceLine" id="cb15-145" data-line-number="145">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="kw">character</span>(<span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb15-146" data-line-number="146">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-147" data-line-number="147"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-148" data-line-number="148">  xpectr<span class="op">::</span><span class="kw">strip</span>(side_effects_<span class="dv">17365</span>[[<span class="st">'messages'</span>]]),</a>
<a class="sourceLine" id="cb15-149" data-line-number="149">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;'z' was 10!</span><span class="ch">\n</span><span class="st">&quot;</span>),</a>
<a class="sourceLine" id="cb15-150" data-line-number="150">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-151" data-line-number="151"><span class="co"># Assigning output</span></a>
<a class="sourceLine" id="cb15-152" data-line-number="152">output_<span class="dv">17365</span> &lt;-<span class="st"> </span>xpectr<span class="op">::</span><span class="kw">suppress_mw</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb15-153" data-line-number="153"><span class="co"># Testing class</span></a>
<a class="sourceLine" id="cb15-154" data-line-number="154"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-155" data-line-number="155">  <span class="kw">class</span>(output_<span class="dv">17365</span>),</a>
<a class="sourceLine" id="cb15-156" data-line-number="156">  <span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb15-157" data-line-number="157">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-158" data-line-number="158"><span class="co"># Testing type</span></a>
<a class="sourceLine" id="cb15-159" data-line-number="159"><span class="kw">expect_type</span>(</a>
<a class="sourceLine" id="cb15-160" data-line-number="160">  output_<span class="dv">17365</span>,</a>
<a class="sourceLine" id="cb15-161" data-line-number="161">  <span class="dt">type =</span> <span class="st">&quot;double&quot;</span>)</a>
<a class="sourceLine" id="cb15-162" data-line-number="162"><span class="co"># Testing values</span></a>
<a class="sourceLine" id="cb15-163" data-line-number="163"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-164" data-line-number="164">  output_<span class="dv">17365</span>,</a>
<a class="sourceLine" id="cb15-165" data-line-number="165">  <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb15-166" data-line-number="166">  <span class="dt">tolerance =</span> <span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb15-167" data-line-number="167"><span class="co"># Testing names</span></a>
<a class="sourceLine" id="cb15-168" data-line-number="168"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-169" data-line-number="169">  <span class="kw">names</span>(output_<span class="dv">17365</span>),</a>
<a class="sourceLine" id="cb15-170" data-line-number="170">  <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb15-171" data-line-number="171">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-172" data-line-number="172"><span class="co"># Testing length</span></a>
<a class="sourceLine" id="cb15-173" data-line-number="173"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-174" data-line-number="174">  <span class="kw">length</span>(output_<span class="dv">17365</span>),</a>
<a class="sourceLine" id="cb15-175" data-line-number="175">  1L)</a>
<a class="sourceLine" id="cb15-176" data-line-number="176"><span class="co"># Testing sum of element lengths</span></a>
<a class="sourceLine" id="cb15-177" data-line-number="177"><span class="kw">expect_equal</span>(</a>
<a class="sourceLine" id="cb15-178" data-line-number="178">  <span class="kw">sum</span>(xpectr<span class="op">::</span><span class="kw">element_lengths</span>(output_<span class="dv">17365</span>)),</a>
<a class="sourceLine" id="cb15-179" data-line-number="179">  1L)</a>
<a class="sourceLine" id="cb15-180" data-line-number="180"></a>
<a class="sourceLine" id="cb15-181" data-line-number="181"><span class="co"># Testing fn(x = 2, y = 0, z = NULL)</span></a>
<a class="sourceLine" id="cb15-182" data-line-number="182"><span class="co"># Changed from baseline: z = NULL</span></a>
<a class="sourceLine" id="cb15-183" data-line-number="183">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb15-184" data-line-number="184"><span class="co"># Testing side effects</span></a>
<a class="sourceLine" id="cb15-185" data-line-number="185"><span class="kw">expect_error</span>(</a>
<a class="sourceLine" id="cb15-186" data-line-number="186">  xpectr<span class="op">::</span><span class="kw">strip_msg</span>(<span class="kw">fn</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">z =</span> <span class="ot">NULL</span>)),</a>
<a class="sourceLine" id="cb15-187" data-line-number="187">  xpectr<span class="op">::</span><span class="kw">strip</span>(<span class="st">&quot;argument is of length zero&quot;</span>),</a>
<a class="sourceLine" id="cb15-188" data-line-number="188">  <span class="dt">fixed =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-189" data-line-number="189"></a>
<a class="sourceLine" id="cb15-190" data-line-number="190"><span class="co">## Finished testing 'fn'                                                    ####</span></a></code></pre></div>
</div>
<div id="rstudio-addins" class="section level3">
<h3>RStudio Addins</h3>
<p>Below, we present the set of <code>RStudio</code> addins. The intention is for you to set up key commands for the ones you’d like access to. Once you get used to using them, they will speed up your testing process.</p>
<div id="how-to-set-up-a-key-command-in-rstudio" class="section level4">
<h4>How to set up a key command in RStudio</h4>
<p>Here’s a small guide for setting up key comands in <code>RStudio</code>. We use the <code>Insert Expectations</code> addin as an example:</p>
<p>After installing the package, go to:</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.</p>
<p>Find <code>&quot;Insert Expectations&quot;</code> and press its field under <code>Shortcut</code>.</p>
<p>Press desired key command, e.g. <code>Alt+E</code>.</p>
<p>Press <code>Apply</code>.</p>
<p>Press <code>Execute</code>.</p>
</div>
<div id="initializegxsfunctionaddin" class="section level4">
<h4>initializeGXSFunctionAddin</h4>
<p>The <code>initializeGXSFunctionAddin</code> initializes the <code>gxs_function()</code> call with the argument names and default values of a selected function. We can then add the argument values and additional combinations we wish to test. Note, that we don’t need to use the default values as our baseline values.</p>
<p>The <code>Tip</code> comment tells us to comment out the <code>gxs_function()</code> call after running it, instead of removing it. When you change your code, it’s often much quicker to regenerate the tests than to update them manually. You can then use a diff tool to check that only the intended changes were made.</p>
<p>The <code>#</code> in the end helps the code be inserted right after the call to <code>gxs_function()</code>.</p>
<p>Suggested keycommand: <code>Alt+F</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">initializeGXSFunctionAddin</span>(<span class="st">&quot;fn&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># Inserts the following:</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># Generate expectations for 'fn'</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co"># Tip: comment out the gxs_function() call</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># so it is easy to regenerate the tests</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">xpectr<span class="op">::</span><span class="kw">gxs_function</span>(</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  <span class="dt">fn =</span> fn,</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">  <span class="dt">args_values =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">    <span class="st">&quot;x&quot;</span> =<span class="st"> </span><span class="kw">list</span>(),</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">    <span class="st">&quot;y&quot;</span> =<span class="st"> </span><span class="kw">list</span>(),</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">    <span class="st">&quot;z&quot;</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">  ),</a>
<a class="sourceLine" id="cb16-16" data-line-number="16">  <span class="dt">identation =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb16-17" data-line-number="17">  <span class="dt">copy_env =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18">)</a>
<a class="sourceLine" id="cb16-19" data-line-number="19"></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">#</span></a></code></pre></div>
</div>
<div id="wrapstringaddin" class="section level4">
<h4>wrapStringAddin</h4>
<p>The <code>wrapStringAddin</code> splits long strings and wraps them with <code>paste0()</code>.</p>
<p>Suggested keycommand: <code>Alt+P</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">wrapStringAddin</span>(<span class="st">&quot;This is a fairly long sentence that we would very very much like to make shorter in our test file!&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># Inserts the following:</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw">paste0</span>(<span class="st">&quot;This is a fairly long sentence that we would very very much &quot;</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">       <span class="st">&quot;like to make shorter in our test file!&quot;</span>)</a></code></pre></div>
</div>
<div id="initializetestthataddin" class="section level4">
<h4>initializeTestthatAddin</h4>
<p>Suggested keycommand: <code>Alt+T</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">initializeTestthatAddin</span>()</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co"># Inserts the following:</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">test_that</span>(<span class="st">&quot;testing ...()&quot;</span>, {</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">  xpectr<span class="op">::</span><span class="kw">set_test_seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">  <span class="co"># ...</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"></a>
<a class="sourceLine" id="cb18-10" data-line-number="10">})</a></code></pre></div>
</div>
<div id="assertcollectionaddin" class="section level4">
<h4>assertCollectionAddin</h4>
<p>Suggested keycommand: <code>Alt+C</code></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">assertCollectionAddin</span>()</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co"># Inserts the following:</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># Check arguments ####</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">assert_collection &lt;-<span class="st"> </span>checkmate<span class="op">::</span><span class="kw">makeAssertCollection</span>()</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co"># checkmate::assert_ , add = assert_collection)</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">checkmate<span class="op">::</span><span class="kw">reportAssertions</span>(assert_collection)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co"># End of argument checks ####</span></a></code></pre></div>
</div>
<div id="dputselectedaddin" class="section level4">
<h4>dputSelectedAddin</h4>
<p>Suggested keycommand: <code>Alt+D</code></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">dputSelectedAddin</span>(<span class="st">&quot;v&quot;</span>)  <span class="co"># &quot;v&quot; is the selected code</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co"># Inserts the following:</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div>
</div>
<div id="navigatetestfileaddin" class="section level4">
<h4>navigateTestFileAddin</h4>
<p>Suggested keycommand: <code>Alt+N</code></p>
<p>A common work process in package development is to run <code>Ctrl/Cmd+Shift+L</code>, which runs all <code>testthat</code> tests in <code>/tests/testthat/</code> in the <code>Build</code> pane.</p>
<p>When a test fails, a message like the following is printed: <code>test_x.R:15: failure: x works</code>.</p>
<p>If we then copy the <code>test_x.R:15:</code> part to our clipboard and run <code>navigateTestFileAddin()</code>, it will open the <code>test_x.R</code> file and place the cursor at line <code>15</code>.</p>
<p>A service like <code>Travis CI</code> indicate the failed test with <code>(@test_x.R#15)</code>. The addin therefore also works with <code>test_x.R#15</code>. If you have additional formats you would like to request, simply open an issue.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
